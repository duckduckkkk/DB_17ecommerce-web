{% extends "backstage.html" %}
{% block head %}
{{ super() }}
<style>
  .product-container {
    max-width: 1000px;
    margin: 30px auto;
  }

  .product-card {
    border: 1px solid #ddd;
    border-radius: 10px;
    padding: 15px 20px;
    margin-bottom: 15px;
    background-color: #fff;
    box-shadow: 0 1px 3px rgba(0,0,0,0.08);
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .product-info {
    flex: 3;
  }

  .product-info h5 {
    margin-bottom: 5px;
  }

  .product-info p {
    margin: 0;
    color: #555;
  }

  .product-actions {
    flex: 1;
    text-align: right;
  }

  .product-actions button {
    width: 48%;
  }

  .search-add {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 25px;
  }

  .search-add .form-control {
    max-width: 250px;
  }

  hr {
    border-top: 2px solid #eee;
  }
</style>
{% endblock head %}

{% block title %}商品管理{% endblock title %}

{% block content %}
{% with messages = get_flashed_messages() %}
  {% if messages %}
    <script>
      document.addEventListener("DOMContentLoaded", function(){
        {% for msg in messages %}
          alert("{{ msg }}");
        {% endfor %}
      });
    </script>
  {% endif %}
{% endwith %}

<script>
$(document).ready(function(){
  $("#keyword").on("keyup", function() {
    var value = $(this).val().toLowerCase();
    $(".product-card").filter(function() {
      $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
    });
  });
});
</script>

<div class="container product-container">

  <div class="search-add">
  <div class="search-box">
    <i class="bi bi-search search-icon"></i>
    <input class="form-control search-input" id="keyword" placeholder="搜尋商品...">
  </div>

  <button type="button" class="btn btn-outline-success" data-bs-toggle="modal" data-bs-target="#staticBackdrop">
    新增商品
  </button>
</div>


  <form method="post" action="{{ url_for('manager.productManager') }}">
    {% for i in book_data %}
    <div class="product-card">
      <div class="product-info">
        <h5>{{ i.商品名稱 }}</h5>
        <p>商品編號：{{ i.商品編號 }}</p>
        <p>售價：NT${{ i.商品售價 }}</p>
        <p>類別：{{ i.商品類別 }}　|　供應商：{{ i.供應商名稱 }}</p>
      </div>
      <div class="product-actions">
        <button type="submit" value="{{ i.商品編號 }}" name="edit" class="btn btn-success">編輯</button>
        <button type="submit" value="{{ i.商品編號 }}" name="delete" class="btn btn-danger"
          onclick="return confirm('確定刪除 {{ i.商品名稱 }} 嗎？')">刪除</button>
      </div>
    </div>
    {% endfor %}
  </form>
</div>

<!-- 新增商品 Modal -->
<form method="post" enctype="multipart/form-data" action="{{ url_for('manager.add') }}">
  <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">新增商品</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <label class="form-label">商品名稱</label>
            <input type="text" class="form-control" name="pname" required>
          </div>
          <div class="mb-3">
            <label class="form-label">商品單價</label>
            <input type="number" class="form-control" name="price" required>
          </div>
          <div class="mb-3">
            <label class="form-label">商品種類</label>
            <select class="form-select" name="category" required>
              <option selected disabled value="">請選擇類型</option>
              <option value="上身">上身</option>
              <option value="下身">下身</option>
              <option value="其他">其他</option>
            </select>
          </div>
          <div class="mb-3">
            <label class="form-label">商品敘述</label>
            <textarea class="form-control" name="description" required></textarea>
          </div>
          <div class="mb-3">
            <label class="form-label">供應商名稱</label>
            <input type="text" class="form-control" name="supplier_name" required>
          </div>
          <div class="mb-3">
            <label class="form-label">供應商聯絡資訊</label>
            <input type="text" class="form-control" name="supplier_contact" required>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-danger" data-bs-dismiss="modal">取消</button>
          <button type="submit" class="btn btn-success">確定新增</button>
        </div>
      </div>
    </div>
  </div>
</form>

{% endblock content %}

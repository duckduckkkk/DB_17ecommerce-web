{% extends "base.html" %}

{% block head %}
{{ super() }}
<style>
/* Body & font */
body {
    background-color: #fff;
    font-family: 'Noto Sans TC', sans-serif;
    overflow-x: hidden;
}

/* 註冊區塊 */
.outer_div {
    position: absolute;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    text-align: center;
    background-color: rgba(255,255,255,0.85);
    border: 2px dashed rgba(25,167,100,0.5);
    border-radius: 20px;
    padding: 50px 60px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.1);
    display: inline-block;
    position: relative;
    
}

.icon {
    width: 80px;
    height: 80px;
    margin-bottom: 20px;
}

.register_title {
    font-size: 2.5rem;
    font-weight: 700;
    color: #0d6040;
    margin-bottom: 20px;
}

.form_div { 
    display: flex; 
    flex-direction: column; 
    align-items: center; 
}

input, select {
    padding: 8px 10px;
    border-radius: 6px;
    border: 1px solid rgba(0,0,0,0.2);
    width: 250px;
    margin-top: 5px;
}

.btn-row {
    display: flex;
    justify-content: center;
    gap: 20px;
    flex-wrap: wrap;
}

.register_btn, .login-btn {
    background: linear-gradient(90deg, #0d8485, #19a764); /* 漸層 */
    border: none;
    color: white;
    font-size: 1.2rem;
    font-weight: 600;
    padding: 12px 30px; /* 上下左右內距 */
    border-radius: 8px;
    cursor: pointer;

    display: inline-flex;       /* 使用 flex 置中 */
    align-items: center;        /* 垂直置中 */
    justify-content: center;    /* 水平置中 */
    text-align: center;         /* 防止多行文字錯位 */
    line-height: 1.2;           /* 避免文字被壓縮 */
    white-space: nowrap;        /* 不換行 */
    transition: all 0.3s ease;
}

.register_btn:hover, .login-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}


.same_accoount {
    color: red;
    font-size: 0.95rem;
    margin-top: 5px;
}

/* 飄落葉子 */
.falling-leaf {
    position: fixed;
    top: -50px;
    width: 30px;
    height: 30px;
    fill: #19a764;
    animation: fall linear infinite;
}

@keyframes fall {
    0% { transform: translateY(-50px) rotate(0deg); opacity: 0; }
    10% { opacity: 1; }
    100% { transform: translateY(110vh) rotate(360deg); opacity: 0.7; }
}

#falling-leaves { pointer-events: none; }
</style>
{% endblock head %}

{% block title %}Register Page{% endblock title %}

{% block content %}
<div class="position-absolute top-50 start-50 translate-middle outer_div">
    <!-- 葉子 logo -->
    <a href="{{ url_for('index') }}">
        <svg class="icon" viewBox="0 0 24 24" width="80" height="80" fill="#19a764">
            <path d="M12 2C10 6 4 8 4 14c0 4 4 8 8 8s8-4 8-8c0-6-6-8-8-12z"/>
        </svg>
    </a>

    <h1 class="register_title mb-3 mt-3">註冊</h1>

    <div class="form_div">
        <form method="post" action="{{ url_for('api.register') }}">
            <p class="mb-3">姓名：<input type="text" name="username" required/></p>

            <p class="mb-3">
                帳號：<input type="text" name="account" required/>
                {% with messages = get_flashed_messages() %}
                {% if messages %}
                <p class="same_accoount">*已經有相同的帳號名稱</p>
                {% endif %}
                {% endwith %}
            </p>

            <p class="mb-4">密碼：<input type="password" name="password" required/></p>
            <p class="mb-3">電話：<input type="tel" name="phone" placeholder="請輸入您的電話號碼" required/></p>
            <p class="mb-3">地址：<input type="text" name="address" placeholder="請輸入您的通訊地址" required/></p>

            <div class="btn_div mb-4" style="margin-bottom: 1rem;">
                <p class="option_div">選擇你要註冊的身份：</p>
                <select name="identity">
                    <option value="user" selected>使用者</option>
                    <option value="manager">管理員</option>
                </select>
            </div>

            <div class="btn-row">
                <a href="{{ url_for('index') }}" class="register_btn">回上頁</a>
                <button type="submit" class="register_btn">註冊</button>
            </div>

        </form>
    </div>
</div>

<!-- 飄落葉子容器 -->
<div id="falling-leaves"></div>
<script>
function startFallingLeaves(){
    const container = document.getElementById('falling-leaves');
    for(let i=0;i<15;i++){
        let leaf = document.createElementNS("http://www.w3.org/2000/svg","svg");
        leaf.setAttribute("class","falling-leaf");
        leaf.setAttribute("viewBox","0 0 24 24");
        leaf.style.left = Math.random()*95 + "vw";
        leaf.style.animationDuration = (5+Math.random()*5)+"s";
        leaf.style.width = (20+Math.random()*20)+"px";
        leaf.style.height = (20+Math.random()*20)+"px";
        let path = document.createElementNS("http://www.w3.org/2000/svg","path");
        path.setAttribute("d","M12 2C10 6 4 8 4 14c0 4 4 8 8 8s8-4 8-8c0-6-6-8-8-12z");
        path.setAttribute("fill","#19a764");
        leaf.appendChild(path);
        container.appendChild(leaf);
    }
}
window.addEventListener("load", startFallingLeaves);
</script>
{% endblock content %}
